$(document).ready(function(){function e(e){$.each(e,function(e,t){var a=t.image,i=t.id;$(".photo-list").each(function(e){$(this).prepend('           <label style="background-image:url('+_url+a+');">             <input type="checkbox" name="photo" value="'+i+'">           </label>         ')})})}function t(){$.ajax({url:_url+"/photo/",dataType:"json",success:function(t){e(t.photo_list)}})}function a(e){var t=/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;return t.test(e)}t(),$(window).load(function(){$(".slide.n1").addClass("active"),$("body").on("tap",".btn, .btn-nostyle",function(e){if(e.preventDefault(),href=$(this).attr("href").split("#"),href[1]&&$("."+href[1]).size()>0&&!$(this).is(".disabled"))if("isprinted"==href[1]){var t=$('.slide.print .photo-list input[type="checkbox"]:checked').val();$.ajax({url:_url+"/print/"+t,success:function(e){}}),$(".slide").removeClass("active"),$("."+href[1]).addClass("active")}else if("isemailsend"==href[1]){var a,i=[];$('.slide.email .photo-list input[type="checkbox"]:checked').each(function(){i.push($(this).val())}),console.log(i),a=$('input[name="email"]').val();var s=$(".slide.email .photo-list").serialize();$.ajax({url:_url+"/email/",data:s+"&"+$.param({email:a}),success:function(e){console.log(e)}}),$(".slide").removeClass("active"),$("."+href[1]).addClass("active")}else if("preview"==href[1]){var n=$(".participate-photo .photo-list input:checked").closest("label").css("background-image").replace("url(","").replace(")",""),l=$('.slide.answer textarea[name="answer"]').val();$(".slide.preview .text p").text(l),$(".slide.preview .photo img").attr("src",n),$(".slide").removeClass("active"),$("."+href[1]).addClass("active")}else if("participate-photo"==href[1])$(".slide.participate-photo .photo-list input").prop("checked",!1),$(".slide.participate-photo .photo-list input").change(),$(".slide").removeClass("active"),$("."+href[1]).addClass("active");else if("isparicipate"==href[1]){var s=$(".slide.participate-photo .photo-list").serialize(),o=$('.slide.answer textarea[name="answer"]').val(),c=$(".slide.socials form").serialize(),d=$(".js-reg-form").serialize(),r=$(".js-city-form").serialize();$.ajax({url:_url+"/participate/",data:d+"&"+r+"&"+s+"&"+c+"&"+$.param({answer:o}),success:function(e){console.log(e)}}),$(".slide").removeClass("active"),$("."+href[1]).addClass("active")}else $(".slide").removeClass("active"),$("."+href[1]).addClass("active")}),$('input[type="checkbox"][name="agree"]').change(function(){$(this).closest(".slide").find("a.btn").toggleClass("disabled")}),$('textarea[name="answer"]').bind("input propertychange",function(e){""==$(this).val()?$(this).closest(".slide").find("a.btn").addClass("disabled"):$(this).closest(".slide").find("a.btn").removeClass("disabled")}),$('input[name="email"]').bind("input propertychange",function(e){a($(this).val())?$(this).closest(".slide").find("a.btn").removeClass("disabled"):$(this).closest(".slide").find("a.btn").addClass("disabled")}),$("body").on("change",'.photo-list label input[type="checkbox"]',function(){var e=$(this).closest(".photo-list"),t=$(this).closest(".photo-list").find('input[type="checkbox"]'),a=e.attr("data-maxselect"),i=e.find('input[type="checkbox"]:checked').size();i>=a?t.filter(":not(:checked)").attr("disabled",!0):t.removeAttr("disabled");var s=$(this).closest(".slide");s.find('input[type="checkbox"]:checked').size()>0?s.find(".btn").removeClass("disabled"):s.find(".btn").addClass("disabled")})}),$(document).on("touchstart",".btn",function(){$(this).addClass("btn-on-active")}).on("touchend",".btn",function(){$(this).removeClass("btn-on-active")});var i=function(){$(".js-placeholder").each(function(){var e=$(this),t=e.find(".js-ph-text"),a=e.find("input");a.attr("data-padding-left",t.width()+19),a.attr("data-placeholder",a.attr("placeholder")),a.on("focus",function(){if(0==$(this).val().length){var e=parseInt($(this).attr("data-padding-left"));$(this).css({"padding-left":e}),$(this).attr("placeholder",""),t.show()}}).on("focusout",function(){0==$(this).val().length&&($(this).css({"padding-left":18}),$(this).attr("placeholder",$(this).attr("data-placeholder")),t.hide())})})},s=function(){var e=$(".js-reg-form"),t=e.find("a[href]"),a=function(){var a=!0;e.find("input").each(function(){$(this).val().length||(a=!1)}),a?t.removeClass("disabled"):t.addClass("disabled")};e.on("input",a),a()},n=function(){$(".js-styled-select").each(function(){var e=$(this),t=e.find("select"),a=e.find(".js-select-text"),i=function(){a.text(t.find("option:selected").text())};i(),t.on("change",i)})},l=function(){var e={count:3,time:4e3,path:"images/back-",parent:".js-background",active:0},t=function(){$(e.parent).find("li").eq(e.active).addClass("active").siblings().removeClass("active"),e.active++,e.active==e.count&&(e.active=0),setTimeout(t,e.time)},a=function(){for(var a=0;a<e.count;a++)$(e.parent).append('<li style="background-image: url('+e.path+a+'.jpg);"></li>');t()};a()};i(),s(),n(),l()});